name: Only allow PR to main from dev

on:
  pull_request_target:
    types:
      - opened
    branches:
      - 'main'


jobs:
  check-branch:
    runs-on: ubuntu-latest
    steps:
      - name: Check branch
        run: |
          if [ "${{ github.head_ref }}" != "dev" ]; then
            echo "Error: Pull requests to main must come from the dev branch"
            exit 1
          fi
      - name: Close Pull Request
        # You may pin to the exact commit or the version.
        # uses: superbrothers/close-pull-request@941c41e49ced0c13047ed30146e82bd762e907a9
        uses: superbrothers/close-pull-request@v3.0.0
        with:
          # Post a issue comment just before closing a pull request.
          comment: Only dev can  merge into main. Please submit your PR to the dev branch instead.
